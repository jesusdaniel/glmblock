# Simultaneous prediction and community detection for networks 

This repository contains R code that implements a block-structured regularization for regression problems with network-valued covariates to perform supervised community detection and regularized regression simultaneously (see the arxiv manuscript [Arroyo and Levina (2019)](https://arxiv.org/abs/2002.01645)).

## Methodology

Given a sample of N pairs of networks with <a href="https://www.codecogs.com/eqnedit.php?latex=n" target="_blank"><img src="https://latex.codecogs.com/gif.latex?n" title="n" /></a> aligned vertices (represented with their <a href="https://www.codecogs.com/eqnedit.php?latex=n\times&space;n" target="_blank"><img src="https://latex.codecogs.com/gif.latex?n\times&space;n" title="n\times n" /></a> adjacency matrices) and responses <a href="https://www.codecogs.com/eqnedit.php?latex=(A^{(1)},&space;Y_1),&space;\ldots,&space;(A^{(m)},&space;Y_n)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?(A^{(1)},&space;Y_1),&space;\ldots,&space;(A^{(m)},&space;Y_n)" title="(A^{(1)}, Y_1), \ldots, (A^{(m)}, Y_n)" /></a>, where <a href="https://www.codecogs.com/eqnedit.php?latex=Y_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Y_i" title="Y_i" /></a> is a real-valued variable, the method fits a regression model to predict <a href="https://www.codecogs.com/eqnedit.php?latex=Y_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Y_i" title="Y_i" /></a> using a linear combination of the entries of <a href="https://www.codecogs.com/eqnedit.php?latex=A^{(i))}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A^{(i))}" title="A^{(i))}" /></a>. A matrix <a href="https://www.codecogs.com/eqnedit.php?latex=B\in\mathbb{R}^{n\times&space;n}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?B\in\mathbb{R}^{n\times&space;n}" title="B\in\mathbb{R}^{n\times n}" /></a> encodes the coefficients of the linear model to form a prediction rule of the form
<p style="text-align: center;"><a href="https://www.codecogs.com/eqnedit.php?latex=\widehat{Y}_i&space;=&space;f(\langle&space;A^{(i))},&space;B\rangle&space;&plus;&space;b)&space;=&space;f\left(\sum_{u=1}^n\sum_{v=1}^n&space;A^{(i)}_{uv}B_{uv}&space;&plus;&space;b&space;\right&space;)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\widehat{Y}_i&space;=&space;f(\langle&space;A^{(i))},&space;B\rangle&space;&plus;&space;b)&space;=&space;f\left(\sum_{u=1}^n\sum_{v=1}^n&space;A^{(i)}_{uv}B_{uv}&space;&plus;&space;b&space;\right&space;)" title="\widehat{Y}_i = f(\langle A^{(i))}, B\rangle + b) = f\left(\sum_{u=1}^n\sum_{v=1}^n A^{(i)}_{uv}B_{uv} + b \right )" /></a>,</p>
where <a href="https://www.codecogs.com/eqnedit.php?latex=f" target="_blank"><img src="https://latex.codecogs.com/gif.latex?f" title="f" /></a> is a link function and <img src="https://latex.codecogs.com/gif.latex?b\in\mathbb{R}" title="b\in\mathbb{R}" /> is the intercept of the regression. 
